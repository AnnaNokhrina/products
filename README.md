# Прием/списание товаров


Контекст приемки реализовани больше всего. Сущности Документ, Товар, Поставщик, Документ Списания, Документ приемки, Операции хранения (название??)
3 контекста. В каждом свои репозитории, сущности с разным поведением и набором свойств.

## Контексты:

### Контекст приемка


Менеджер загружает документ счета-фактуры, добавляем документ командой AddDocInvoice. 
Данные, спаршенные из документа хранятся в таблице документа, сущность документ.
Если товара или потавщика из документа не существует в нашей системе, мы тут же синхронно добавляем их.
Далее пушится событие InvoiceDocHasBeenCreated о создании документа (загрузке в систему)

Слушаем событие InvoiceDocHasBeenCreated где-то в сервисе приемки, и по данным из события заполняем операции хранения по товарам.
Например на склад 1 привезли 20 диванов (product_id = 1) и 2 стола (product_id = 2). На склад 2 привезли 50 диванов.

| id | stock_id | product_id | count | actor     |
|----|----------|------------|-------|-----------|
| 1  | 1        | 1          | 20    | provider  |
| 2  | 1        | 2          | 2     | provider  |        
| 3  | 2        | 1          | 50    | provider  |


## Контекст списание

Менеджер загружает документ списание, добавляем документ командой AddDocWriteOff.
Данные, спаршенные из документа хранятся в таблице документа, сущность документ.
Далее пушится событие WriteOffDocHasBeenCreated о создании документа (загрузке в систему)

Слушаем событие WriteOffDocHasBeenCreated где-то в сервисе списания, и по данным из события заполняем операции хранения по товарам.
Они будут с минусом. 
Например со склада 1 списали 5 диванов, а со склада 2 10.

| id | stock_id | product_id | count | actor    |
|----|----------|------------|-------|----------|
| 1  | 1        | 1          | 20    | provider |
| 2  | 1        | 2          | 2     | provider |        
| 3  | 2        | 1          | 50    | provider |
| 4  | 1        | 1          | -5    | stock    |
| 5  | 2        | 1          | -10   | stock    |


## Контекст хранение

Здесь можно создать новый склад AddStock команда (например построили) или удалить.

Сущности, репозитории и дто раскиданы по контекста тк в зависимости от контекста могут иметь разный набор свойств и разное поведение.


## Контекст общий

Здесь лежит все, что не меняестя в зависимости от контекста, на данный момент - объекты-значения.
